<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <section>
        <div>
            <button class="testBtn1" onclick="button1()">click1</button>
        </div>
        <div>
            <button class=testBtn2 onclick="button2()" >click2</button>
        </div>
        <div>
            <button class=testBtn3 onclick="button3()" >click3</button>
        </div>
    </section>
    <!-- <script src="./src/js/main.js"></script>
    <script src="./src/js/customerService"></script> -->
    <script>
        const customerServiceList = {
					livechat: {
						open(uniqueKey) {
							if (window.LiveChatWidget) {
								const { visibility } = window.LiveChatWidget.get("state"); // 'maximized' | 'minimized' | 'hidden'
								console.log('open stage in if', 'visibility', visibility)
								if (visibility !== 'maximized') {
									window.LiveChatWidget.call("maximize");
								} else {
									window.LiveChatWidget.call("hide");
								}
							} else {
								console.log('open stage in else')
								// 引入Live Chat
								this.preload(uniqueKey, true);
							}
						},
						preload(uniqueKey, show = false) {
							window.__lc = window.__lc || {};
							window.__lc.license = uniqueKey;
							const loaded = () => {
								if (window.LiveChatWidget._h) {
									setTimeout(() => {
										if (show) this.forceOpen(uniqueKey);
									}, 1000);
									return;
								}
								setTimeout(loaded, 500);
							}
							// ;(function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},once:function(){i(["once",c.call(arguments)])},off:function(){i(["off",c.call(arguments)])},get:function(){if(!e._h)throw new Error("[LiveChatWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},call:function(){i(["call",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.livechatinc.com/tracking.js",t.head.appendChild(n)}};!n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e}(window,document,[].slice))
							(function livechatfn(n, t, c) {
								let e;
								function iLivechatfn(n) { return e._h ? e._h.apply(null, n) : e._q.push(n) }
								e = {
									_q: [],
									_h: null,
									_v: "2.0",
									on: function iLivechatfnOn() {
										iLivechatfn(["on", c.call(arguments)])
									},
									once: function iLivechatfnOnce() {
										iLivechatfn(["once", c.call(arguments)])
									},
									off: function iLivechatfnOff() {
										iLivechatfn(["off", c.call(arguments)])
									},
									get: function iLivechatfnGet() {
										if (!e._h) throw new Error("[LiveChatWidget] You can't use getters before load.");
										return iLivechatfn(["get", c.call(arguments)])
									},
									call: function iLivechatfnCall() {
										iLivechatfn(["call", c.call(arguments)])
									},
									init: function iLivechatfnInit() {
										let s1 = document.createElement("script");
										let s0 = document.getElementsByTagName("script")[0];
										s1.async = true;
										s1.type = "text/javascript";
										s1.src = "https://cdn.livechatinc.com/tracking.js";
										s1.onload = loaded;
										s0.parentNode.insertBefore(s1,s0);
									}
								};
								!n.__lc.asyncInit && e.init();
								n.LiveChatWidget = n.LiveChatWidget || e;
							}(window, document, [].slice))
						},
						forceOpen(uniqueKey) {
							let op = () => {
								let { visibility } = window.LiveChatWidget.get("state"); // 'maximized' | 'minimized' | 'hidden'
								console.log('forceOpen stage', 'visibility', visibility)
								if (visibility === 'maximized') return;
								window.LiveChatWidget.call("maximize");
								setTimeout(op, 1000);
							}
							op();
						},
					},
					respondio: {
						preload(urlKey) {
								const checkScript = document.getElementById('respondio__widget');
								let s1 = document.createElement("script");
								let s0 = document.getElementsByTagName("script")[0];
								s1.async = true;
								s1.setAttribute("id", "respondio__widget");
								s1.type = 'text/javascript';
								s1.src = urlKey;
								if (!checkScript) {
										setTimeout(() => {
												s0.parentNode.insertBefore(s1,s0);
												window.location.hash = '#webchat_widget';
										}, 1000);
								}
						},
						open(urlKey) {
								this.preload(urlKey);
						}
					},
					fb: {
						preload(uniqueKey) {
							let root = document.createElement("div");
							root.setAttribute("id", "fb-root");
							let chatbox = document.createElement("div");
							chatbox.setAttribute("id", "fb-customer-chat");
							chatbox.setAttribute("page_id", uniqueKey);
							chatbox.setAttribute("attribution", "biz_inbox");
							let s0 = document.getElementsByTagName("script")[0];
							s0.parentNode.insertBefore(root, s0);
							s0.parentNode.insertBefore(chatbox, s0);
							window.fbAsyncInit = function() {
								FB.init({
									xfbml: true,
									version: 'v13.0'
								});
							};
							(function(d, s, id) {
								var js, fjs = d.getElementsByTagName(s)[0];
								if (d.getElementById(id)) return;
								js = d.createElement(s); js.id = id;
								js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js';
								fjs.parentNode.insertBefore(js, fjs);
							}(document, 'script', 'facebook-jssdk'));
						},
						open(uniqueKey) {
							this.preload(uniqueKey);
						}
					}
        }
        const livechat = [
            'livechat',
            {
                uniqueKey: 12991488,
            }
        ]
        const respondio = [
            'respondio',
            {
                url: "https://cdn.respond.io/webchat/widget/widget.js?cId=502d2e7883909f762888903f142b628a5097e5ba8ad9b9c8073c0a2aeca7607a",

            }
        ]
				const fb = [
					'fb',
					{
						uniqueKey: 105782932135108,
					}
				]
        function button1 () { customerServiceList.livechat.preload(12991488, true) }
        function button2 () { customerServiceList.livechat.open(12991488)}
        function button3 () { customerServiceList.fb.preload(105782932135108)}
        // let testBtn1 = document.querySelector('testBtn1')
        // let testBtn2 = document.querySelector('testBtn2')
        // testBtn1.addEventListener("click", () => {
        //     buttonOne()
        // })
        // testBtn2.addEventListener("click", () => {
        //     buttonTwo()
        // })

    </script>
</body>
</html>